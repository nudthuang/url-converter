<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>URL 转换器</title>
  <style>
    body {
      font-family: system-ui, -apple-system, "PingFang TC", "Microsoft JhengHei", sans-serif;
      max-width: 820px;
      margin: 40px auto;
      padding: 0 16px;
    }
    textarea {
      width: 100%;
      height: 110px;
      padding: 12px;
      font-size: 16px;
      box-sizing: border-box;
    }
    .row { margin: 14px 0; }
    .hint { color: #555; font-size: 14px; }
    .out { background: #f6f6f6; }
    button {
      padding: 10px 14px;
      font-size: 16px;
      cursor: pointer;
    }
    .ok { color: #0a7; font-size: 14px; margin-left: 10px; }
    .err { color: #c00; font-size: 14px; margin-top: 8px; }
  </style>
</head>

<body>
  <h2>URL 转换器</h2>

  <div class="row">
    <div class="hint">输入网址：</div>
    <textarea id="in" placeholder="粘贴原始网址..."></textarea>
    <div id="err" class="err"></div>
  </div>

  <div class="row">
    <div class="hint">输出新网址：</div>
    <textarea id="out" class="out" readonly></textarea>
  </div>

  <div class="row">
    <button id="copy">复制新网址</button>
    <button id="open" style="margin-left:10px;">打开新网址</button>
    <span id="copied" class="ok"></span>
  </div>

<script>
  // ===== 转换规则：兼容电脑端 + 移动端 =====
  // 仅替换域名(host)，其余路径/参数/时间戳全部保留
  const RULES = [
    { from: "www.youtube.com", to: "www.yout-ube.com" },
    { from: "m.youtube.com",   to: "m.yout-ube.com" },
  ];

  function normalizeInputUrl(raw) {
    const s = (raw || "").trim();
    if (!s) return "";

    // 允许用户输入不带协议的形式：www.youtube.com/xxx
    // 也允许直接输入 youtube.com/xxx
    const candidate = s.includes("://") ? s : ("https://" + s);
    return candidate;
  }

  function convertUrl(raw) {
    const candidate = normalizeInputUrl(raw);
    if (!candidate) return "";

    let u;
    try {
      u = new URL(candidate);
    } catch {
      throw new Error("这不是合法的网址（URL）。请检查是否有空格或缺少域名。");
    }

    // 匹配规则并替换 host
    for (const r of RULES) {
      if (u.host === r.from) {
        u.host = r.to;
        break;
      }
    }

    return u.toString();
  }

  const input = document.getElementById("in");
  const output = document.getElementById("out");
  const err = document.getElementById("err");
  const copied = document.getElementById("copied");

  function run() {
    copied.textContent = "";
    err.textContent = "";
    try {
      output.value = convertUrl(input.value);
    } catch (e) {
      output.value = "";
      err.textContent = e.message || String(e);
    }
  }

  input.addEventListener("input", run);

  // 复制按钮
  document.getElementById("copy").addEventListener("click", async () => {
    const url = output.value.trim();
    if (!url) return;

    await navigator.clipboard.writeText(url);
    copied.textContent = "已复制";
    setTimeout(() => copied.textContent = "", 1200);
  });

  // 打开新网址（新标签页，定位到顶部/页眉）
  document.getElementById("open").addEventListener("click", () => {
    const url = output.value.trim();
    if (!url) return;

    const u = new URL(url);
    // 加一个 hash，确保打开后在页面顶部（页眉）
    u.hash = "top";

    window.open(u.toString(), "_blank", "noopener,noreferrer");
  });

  run();
</script>
</body>
</html>
